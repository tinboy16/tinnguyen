"use strict";(self.webpackChunktinnguyen=self.webpackChunktinnguyen||[]).push([[3656],{3142:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>s,default:()=>h,frontMatter:()=>r,metadata:()=>l,toc:()=>o});var i=t(4848),c=t(8453);const r={},s="T\u1ea1o m\u1ed9t images",l={id:"Docker/docker-images",title:"T\u1ea1o m\u1ed9t images",description:"T\u1ea1o Dockerfile",source:"@site/docs/Docker/docker-images.md",sourceDirName:"Docker",slug:"/Docker/docker-images",permalink:"/docs/Docker/docker-images",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"docker-compose",permalink:"/docs/Docker/docker-compose"},next:{title:"L\u1ecbch s\u1eed ph\xe1t tri\u1ec3n Docker",permalink:"/docs/Docker/lich-su-phat-trien-docker"}},a={},o=[{value:"T\u1ea1o Dockerfile",id:"t\u1ea1o-dockerfile",level:2},{value:"Build",id:"build",level:2},{value:"Run container t\u1eeb image \u0111\xe3 t\u1ea1o",id:"run-container-t\u1eeb-image-\u0111\xe3-t\u1ea1o",level:2},{value:"Th\xeam v\xed d\u1ee5 Dockerfile",id:"th\xeam-v\xed-d\u1ee5-dockerfile",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,c.useMDXComponents)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"t\u1ea1o-m\u1ed9t-images",children:"T\u1ea1o m\u1ed9t images"}),"\n",(0,i.jsx)(n.h2,{id:"t\u1ea1o-dockerfile",children:"T\u1ea1o Dockerfile"}),"\n",(0,i.jsx)(n.p,{children:"\u0110\u1ec3 build Docker image, b\u1ea1n c\u1ea7n ph\u1ea3i t\u1ea1o m\u1ed9t file text v\u1edbi t\xean l\xe0 Dockerfile. File n\xe0y \u0111\u1eb7c t\u1ea3 v\xe0 quy \u0111\u1ecbnh c\xe1c tham s\u1ed1, \u0111\u1ec3 build Docker image:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"FROM"})," -- c\xe0i \u0111\u1eb7t Docker image s\u1ebd build d\u1ef1a tr\xean base image n\xe0o"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"RUN"})," -- th\u1ef1c thi command trong container"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"ENV"})," -- c\xe0i \u0111\u1eb7t bi\u1ebfn m\xf4i tr\u01b0\u1eddng"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"WORKDIR"})," -- c\xe0i \u0111\u1eb7t working directory"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"VOLUME"})," -- quy \u0111\u1ecbnh mount th\u01b0 m\u1ee5c n\xe0o th\xe0nh volume"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"CMD"})," -- c\xe0i \u0111\u1eb7t command ch\xednh khi start container"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["Tham kh\u1ea3o th\xeam ",(0,i.jsx)(n.a,{href:"https://docs.docker.com/engine/reference/builder/",children:"Dockerfile reference"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["V\xed d\u1ee5 d\u01b0\u1edbi \u0111\xe2y, ch\xfang ta s\u1ebd t\u1ea1o m\u1ed9t image, v\u1edbi nhi\u1ec7m v\u1ee5 l\u1ea5y d\u1eef li\u1ec7u t\u1eeb m\u1ed9t website s\u1eed d\u1ee5ng curl, sau \u0111\xf3 l\u01b0u v\xe0o file html. \u0110\u1ecba ch\u1ec9 website s\u1ebd \u0111\u01b0\u1ee3c l\u01b0u v\xe0o bi\u1ebfn m\xf4i tr\u01b0\u1eddng ",(0,i.jsx)(n.strong,{children:"SITE_URL"}),". K\u1ebft qu\u1ea3 s\u1ebd l\u01b0u v\xe0o m\u1ed9t th\u01b0 m\u1ee5c \u0111\u01b0\u1ee3c mounted d\u01b0\u1edbi d\u1ea1ng volume."]}),"\n",(0,i.jsxs)(n.p,{children:["T\u1ea1o file ",(0,i.jsx)(n.strong,{children:"Dockerfile"}),", \u0111\u1ec3 trong th\u01b0 m\u1ee5c b\u1ea5t k\u1ef3 ch\u1eb3ng h\u1ea1n ",(0,i.jsx)(n.strong,{children:"examples/curl/Dockerfile"}),", v\u1edbi n\u1ed9i dung:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-dockerfile",children:'FROM ubuntu:latest\nRUN apt-get update \\\n    && apt-get install --no-install-recommends --no-install-suggests -y curl \\\n    && rm -rf /var/lib/apt/lists/*\nENV SITE_URL https://google.com\nWORKDIR /data\nVOLUME /data\nCMD sh -c "curl -Lk $SITE_URL > /data/results.html"\n'})}),"\n",(0,i.jsx)(n.h2,{id:"build",children:"Build"}),"\n",(0,i.jsx)(n.p,{children:"Khi t\u1ea1o xong Dockerfile, ta s\u1ebd b\u1eaft \u0111\u1ea7u build Docker image"}),"\n",(0,i.jsx)(n.p,{children:"G\xf5 l\u1ec7nh d\u01b0\u1edbi \u0111\xe2y:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"docker build . -t test-curl\n"})}),"\n",(0,i.jsx)(n.p,{children:"Console output:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'Sending build context to Docker daemon  3.584kB\nStep 1/6 : FROM ubuntu:latest\n ---\x3e 113a43faa138\nStep 2/6 : RUN apt-get update     && apt-get install --no-install-recommends --no-install-suggests -y curl     && rm -rf /var/lib/apt/lists/*\n ---\x3e Running in ccc047efe3c7\nGet:1 http://archive.ubuntu.com/ubuntu bionic InRelease [242 kB]\nGet:2 http://security.ubuntu.com/ubuntu bionic-security InRelease [83.2 kB]\n...\nRemoving intermediate container ccc047efe3c7\n ---\x3e 8d10d8dd4e2d\nStep 3/6 : ENV SITE_URL http://example.com/\n ---\x3e Running in 7688364ef33f\nRemoving intermediate container 7688364ef33f\n ---\x3e c71f04bdf39d\nStep 4/6 : WORKDIR /data\nRemoving intermediate container 96b1b6817779\n ---\x3e 1ee38cca19a5\nStep 5/6 : VOLUME /data\n ---\x3e Running in ce2c3f68dbbb\nRemoving intermediate container ce2c3f68dbbb\n ---\x3e f499e78756be\nStep 6/6 : CMD sh -c "curl -Lk $SITE_URL > /data/results"\n ---\x3e Running in 834589c1ac03\nRemoving intermediate container 834589c1ac03\n ---\x3e 4b79e12b5c1d\nSuccessfully built 4b79e12b5c1d\nSuccessfully tagged test-curl:latest\n'})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"docker build"})," l\u1ec7nh \u0111\u1ec3 build m\u1ed9t image m\u1edbi \u1edf local."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"-t"})," tham s\u1ed1 \u0111\u1ec3 set tag name cho image."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Sau khi build ho\xe0n th\xe0nh, ch\xfang ta h\xe3y xem l\u1ea1i danh s\xe1ch images:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"docker images\n"})}),"\n",(0,i.jsx)(n.p,{children:"Console output:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"REPOSITORY  TAG     IMAGE ID      CREATED         SIZE\ntest-curl   latest  5ebb2a65d771  37 minutes ago  180 MB\nnginx       latest  6b914bbcb89e  7 days ago      182 MB\nubuntu      latest  0ef2e08ed3fa  8 days ago      130 MB\n"})}),"\n",(0,i.jsx)(n.h2,{id:"run-container-t\u1eeb-image-\u0111\xe3-t\u1ea1o",children:"Run container t\u1eeb image \u0111\xe3 t\u1ea1o"}),"\n",(0,i.jsx)(n.p,{children:"B\xe2y gi\u1edd ta h\xe3y th\u1eed ch\u1ea1y m\u1ed9t container m\u1edbi t\u1eeb image \u0111\xe3 t\u1ea1o:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"docker run --rm -v $(pwd)/vol:/data/:rw test-curl\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"--rm"})," -- t\u1ef1 x\xf3a container sau khi stop"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"-v"})," -- ch\u1ec9 \u0111\u1ecbnh mount volume"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"$(pwd)"})," -- th\u01b0 m\u1ee5c hi\u1ec7n t\u1ea1i"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Ch\u1ea1y l\u1ec7nh b\xean d\u01b0\u1edbi \u0111\u1ec3 xem k\u1ebft qu\u1ea3, trang web c\xf3 \u0111\u01b0\u1ee3c l\u01b0u th\xe0nh file hay kh\xf4ng?:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"cat ./vol/results.html\n"})}),"\n",(0,i.jsx)(n.h2,{id:"th\xeam-v\xed-d\u1ee5-dockerfile",children:"Th\xeam v\xed d\u1ee5 Dockerfile"}),"\n",(0,i.jsxs)(n.p,{children:["Trong Dockerfile b\xean d\u01b0\u1edbi, ta s\u1ebd t\u1ea1o m\u1ed9t file \u1ea3nh d\u1ef1a tr\xean base image ubuntu:18.04, sau \u0111\xf3 c\xe0i \u0111\u1eb7t apache v\xe0 php; EXPOSE port 80, mount volume ",(0,i.jsx)(n.code,{children:"/var/www/htmnl"}),". Ti\u1ebfp theo copy file ",(0,i.jsx)(n.code,{children:"index.html"})," v\xe0 th\u01b0 m\u1ee5c m\u1eb7c \u0111\u1ecbnh c\u1ee7a webserver apache ",(0,i.jsx)(n.code,{children:"/var/www/html"}),"; cu\u1ed1i c\xf9ng c\xe0i \u0111\u1eb7t start apache \u1edf background."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-dockerfile",children:"FROM ubuntu:18.04\n\nMAINTAINER <cancc@vitalify.asia>\n  \nENV DEBIAN_FRONTEND=noninteractive\n\nRUN apt-get update && apt-get install -yq --no-install-recommends \\\n    apt-utils \\\n    # Install apache\n    apache2 \\\n    # Install php\n    php \\\n    libapache2-mod-php \\\n    && apt-get clean && rm -rf /var/lib/apt/lists/*\n\nEXPOSE 80 443\n\nWORKDIR /var/www/html\n\nCOPY index.html /var/www/html/\n\nVOLUME /var/www/html\n\nCMD apachectl -D FOREGROUND\n"})}),"\n",(0,i.jsx)(n.p,{children:"Build:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"docker build . -t ubuntu-php-apache:1.0\n"})}),"\n",(0,i.jsx)(n.p,{children:"Run container:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"docker run -d -p 8080:80 -v $(pwd)/www:/var/www/html --name web001 ubuntu-php-apache:1.0\n"})})]})}function h(e={}){const{wrapper:n}={...(0,c.useMDXComponents)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453:(e,n,t)=>{t.r(n),t.d(n,{MDXProvider:()=>l,useMDXComponents:()=>s});var i=t(6540);const c={},r=i.createContext(c);function s(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:s(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);